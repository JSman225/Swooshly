<!DOCTYPE html>
<html>

<head>
    <link href="/dist/output.css" rel="stylesheet">
</head>

<body class="bg-[#111111] text-white">
    <h1>MongoDB with Netlify Functions</h1>
    <ul id="movies"></ul>
    <button onclick="test()">Test</button>
    <div id="userList"></div>
    <script>
        (async () => {
            let results = await fetch("/.netlify/functions/get_movies").then(response => response.json());
            results.forEach(result => {
                const listItem = document.createElement("li");
                listItem.innerText = result.name;
                document.getElementById("movies").appendChild(listItem);
            });
        })();
        function test() {
    fetch(`/.netlify/functions/search_users?q=`)
        .then(response => response.json())
        .then(data => {
            const userList = document.getElementById("userList");

            data.forEach(user => {
                const userDiv = document.createElement("div");
                userDiv.className = "rounded-2xl w-full h-16 flex justify-start items-center";

                const userImg = document.createElement("img");
                userImg.className = "object-cover rounded-full h-[54px] w-[54px] ml-1.5";
                userImg.src = user.profilePicture;

                const userInfoDiv = document.createElement("div");
                userInfoDiv.className = "text-white font-light ml-3";

                const userName = document.createElement("p");
                userName.className = "flex gap-1";
                userName.innerText = user.name;

                const verifiedImg = document.createElement("img");
                verifiedImg.width = 20;
                verifiedImg.height = 20;
                if (user.verified) {
                    verifiedImg.src = "../assets/blue_check.svg";
                } else {
                    verifiedImg.src = "../assets/gray_check.svg";
                }

                userName.appendChild(verifiedImg);

                const userUsername = document.createElement("p");
                userUsername.className = "text-xs opacity-75";
                userUsername.innerText = user.username;

                userInfoDiv.appendChild(userName);
                userInfoDiv.appendChild(userUsername);

                userDiv.appendChild(userImg);
                userDiv.appendChild(userInfoDiv);

                userList.appendChild(userDiv);
            });
        })
        .catch(error => {
            console.error("An error occurred:", error);
            // Handle the error gracefully
            // ...
        });
}
    </script>
</body>

</html>