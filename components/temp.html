<div class="flex justify-center items-center h-screen">
    <div class="relative">
        <video id="camera-preview" autoplay playsinline class="w-screen h-screen"></video>
        <button id="capture-button"
            class="absolute bottom-5 left-1/2 transform -translate-x-1/2 bg-yellow-500 h-14 w-14 rounded-full border-4 border-white"></button>
        <button id="toggle-camera-button"
            class="absolute bottom-5 left-20 transform -translate-x-1/2 bg-yellow-500 h-14 w-14 rounded-full border-4 border-white"></button>
    </div>
</div>















<script>
    let useFrontCamera = true;

    async function toggleCamera() {
        useFrontCamera = !useFrontCamera;

        try {
            const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: useFrontCamera ? "user" : "environment" } });
            const videoElement = document.getElementById("camera-preview");
            videoElement.srcObject = stream;
        } catch (error) {
            console.error("Error accessing camera:", error);
        }
    }

    async function setupCamera() {
        try {
            const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" } });
            const videoElement = document.getElementById("camera-preview");
            videoElement.srcObject = stream;
        } catch (error) {
            console.error("Error accessing camera:", error);
        }
    }

    const toggleCameraButton = document.getElementById("toggle-camera-button");
    toggleCameraButton.addEventListener("click", toggleCamera);


    setupCamera();

    const captureButton = document.getElementById("capture-button");
    const videoElement = document.getElementById("camera-preview");

    captureButton.addEventListener("click", async () => {
        const canvas = document.createElement("canvas");
        canvas.width = videoElement.videoWidth;
        canvas.height = videoElement.videoHeight;

        const context = canvas.getContext("2d");
        context.drawImage(videoElement, 0, 0, canvas.width, canvas.height);

        // Convert the canvas data to a data URL representing a PNG image
        const imageDataURL = canvas.toDataURL("image/png");

        // Open a new tab with the captured image
        const newTab = window.open();
        newTab.document.write(`<img src="${imageDataURL}" alt="Captured Image" />`);


        const apiKey = '9358b1be7aa72843922a70d9f7789d17'; // Replace with your actual ImgBB API key
        const imgData = imageDataURL; // Replace with your actual base64 encoded image data

        // Convert base64 data to a Blob
        const blob = new Blob([imgData], { type: 'image/png' });

        // Create a FormData object and append the image Blob
        const formData = new FormData();
        formData.append('image', blob, 'image.png');

        // Create the Fetch request options
        const options = {
            method: 'POST',
            body: formData,
        };

        // Make the POST request to ImgBB API
        fetch(`https://api.imgbb.com/1/upload?key=${apiKey}`, options)
            .then(response => response.json())
            .then(data => {
                console.log('Image uploaded successfully:', data);
                // Here, you can access the URL of the uploaded image from the response data
            })
            .catch(error => {
                console.error('Error uploading image:', error);
            });
    });


</script>